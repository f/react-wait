{"version":3,"file":"react-wait.js","sources":["../src/context.js","../src/hooks.js","../src/api.js","../src/provider.js","../src/injectWaiting.js"],"sourcesContent":["import { createContext } from \"react\";\n\nconst WaitingContext = createContext();\n\nexport default WaitingContext;\n","import React, { useContext } from \"react\";\nimport WaitingContext from \"./context\";\n\nfunction Wait(props) {\n  const context = useContext(WaitingContext);\n  return context.waiters.includes(props.on) ? props.fallback : props.children;\n}\n\nexport function useWait() {\n  const context = useContext(WaitingContext);\n  return {\n    ...context,\n    Wait\n  };\n}\n\nexport function createWaitingContext(waiter) {\n  const { isWaiting, startWaiting, endWaiting } = useContext(WaitingContext);\n  return {\n    isWaiting: () => isWaiting(waiter),\n    startWaiting: () => startWaiting(waiter),\n    endWaiting: () => endWaiting(waiter),\n    Wait: props => <Wait on={waiter} {...props} />\n  };\n}\n","export const anyWaiting = waiters => waiters.length > 0;\n\nexport const isWaiting = (waiters, waiter) => waiters.includes(waiter);\n\nexport const startWaiting = (waiters, waiter) => {\n  if (isWaiting(waiters, waiter)) return waiters;\n  return [...waiters, waiter];\n};\n\nexport const endWaiting = (waiters, waiter) => {\n  return waiters.filter(w => w !== waiter);\n};\n","import React, { useState } from \"react\";\nimport { anyWaiting, isWaiting, startWaiting, endWaiting } from \"./api\";\nimport { createWaitingContext } from \"./hooks\";\nimport WaitingContext from \"./context\";\n\nexport function Waiter(props) {\n  const [waiters, setWaiters] = useState([]);\n\n  return (\n    <WaitingContext.Provider\n      value={{\n        waiters,\n        createWaitingContext,\n        anyWaiting: () => anyWaiting(waiters),\n        isWaiting: waiter => isWaiting(waiters, waiter),\n        startWaiting(waiter) {\n          setWaiters(startWaiting(waiters, waiter));\n        },\n        endWaiting(waiter) {\n          setWaiters(endWaiting(waiters, waiter));\n        }\n      }}\n    >\n      {props.children}\n    </WaitingContext.Provider>\n  );\n}\n\nexport default Waiter;\n","import React from \"react\";\nimport hoistNonReactStatics from \"hoist-non-react-statics\";\nimport WaitingContext from \"./context\";\nimport { useWait } from \"./hooks\";\n\nfunction getDisplayName(Component) {\n  return Component.displayName || Component.name || \"Component\";\n}\n\nfunction injectWaiting(\n  WrappedComponent,\n  { forwardRef = false, propName = \"waiting\" } = {}\n) {\n  const WithWaiting = props => {\n    const { Wait } = useWait();\n\n    return (\n      <WaitingContext.Consumer>\n        {value => {\n          value.Wait = Wait;\n          return (\n            <WrappedComponent\n              {...props}\n              {...{\n                [propName]: value\n              }}\n              ref={forwardRef ? props.forwardedRef : null}\n            />\n          );\n        }}\n      </WaitingContext.Consumer>\n    );\n  };\n\n  WithWaiting.displayName = `WithWaiting(${getDisplayName(WrappedComponent)})`;\n  WithWaiting.WrappedComponent = WrappedComponent;\n\n  if (forwardRef) {\n    return hoistNonReactStatics(\n      React.forwardRef((props, ref) => (\n        <WithWaiting {...props} forwardedRef={ref} />\n      )),\n      WrappedComponent\n    );\n  }\n\n  return hoistNonReactStatics(WithWaiting, WrappedComponent);\n}\n\nexport default injectWaiting;\n"],"names":["WaitingContext","createContext","Wait","props","useContext","waiters","includes","on","fallback","children","useWait","const","context","Object","createWaitingContext","waiter","isWaiting","startWaiting","endWaiting","anyWaiting","length","filter","w","useState","WrappedComponent","ref","Component","WithWaiting","displayName","name"],"mappings":"4IAEMA,EAAiBC,kBCCvB,SAASC,EAAKC,GAEZ,OADgBC,aAAWJ,GACZK,QAAQC,SAASH,EAAMI,IAAMJ,EAAMK,SAAWL,EAAMM,SAGrE,SAAgBC,IACdC,IAAMC,EAAUR,aAAWJ,GAC3B,OAAOa,iBACFD,QACHV,IAIG,SAASY,EAAqBC,GACnC,MAAgDX,aAAWJ,iDAC3D,MAAO,CACLgB,4BAAiBA,EAAUD,IAC3BE,+BAAoBA,EAAaF,IACjCG,6BAAkBA,EAAWH,IAC7Bb,cAAMC,0DCtBHQ,IAAMQ,WAAad,UAAWA,EAAQe,OAAS,GAEzCJ,WAAaX,EAASU,UAAWV,EAAQC,SAASS,IAElDE,WAAgBZ,EAASU,GACpC,OAAIC,EAAUX,EAASU,GAAgBV,EAChCA,UAAaU,KAGTG,WAAcb,EAASU,UAC3BV,EAAQgB,gBAAOC,UAAKA,IAAMP,sCCL5B,SAAgBZ,GACrB,MAA8BoB,WAAS,kBAEvC,8PCCF,SACEC,EACAC,kBAA+C,uCAAhC,mCAAkB,WAEjCd,IARsBe,EAQhBC,WAAcxB,GAClB,MAAiBO,SAEjB,kEAkBUR,mIA7BUwB,KACLE,aAAeF,EAAUG,MAAQ"}